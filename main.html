<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AB AGRIWEB — Dashboard</title>
<style>
  :root{
    --bg:#0f2135; --panel:#0f1b2d; --text:#e6f6e6; --muted:#9fb3c8; --accent:#7CFC00; --border:#243248;
  }
  *{box-sizing:border-box}
  body{margin:0; background:var(--bg); color:var(--text); font:15px/1.4 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
  .topbar{
    height:56px; display:flex; align-items:center; justify-content:space-between;
    padding:0 12px 0 10px; border-bottom:1px solid var(--border);
    background:linear-gradient(180deg,#0e1b2c,#0c1726);
    position:sticky; top:0; z-index:50;
  }
  .hamb{font-size:22px; cursor:pointer}
  .title{font-weight:800; letter-spacing:.6px}
  .rightslot{display:flex; align-items:center; gap:10px}
  .rightslot img{height:26px; width:auto; object-fit:contain}

  .wrap{padding:14px}
  .card{background:var(--panel); border:1px solid var(--border); border-radius:16px; padding:14px; margin-bottom:14px}

  /* Accordion بسيط */
  .acc{border-radius:16px; overflow:hidden; border:1px solid var(--border)}
  .acc-sec + .acc-sec{border-top:1px solid var(--border)}
  .acc-hd{padding:14px; background:#0f1b2d; cursor:pointer; display:flex; align-items:center; justify-content:space-between}
  .acc-bd{display:none; padding:14px; background:#0e1a2a}
  .acc-sec.open .acc-bd{display:block}

  .row{display:grid; grid-template-columns:1fr; gap:10px}
  label{font-size:13px; color:var(--muted)}
  .inp{display:flex; gap:8px; align-items:center; background:#0e1a2a; border:1px solid var(--border); padding:10px 12px; border-radius:12px}
  .inp input[type="text"]{flex:1; background:transparent; border:0; outline:0; color:var(--text)}
  .btn{background:var(--accent); color:#07150e; font-weight:700; border:0; padding:10px 12px; border-radius:12px; cursor:pointer}
  .muted{color:var(--muted); font-size:12px}
  .hint{font-size:12px; color:var(--muted)}
  .hr{height:1px;background:var(--border); margin:10px 0}
  .note{font-size:12px; color:#cde7ff}
</style>
</head>
<body>

  <!-- Topbar -->
  <div class="topbar">
    <div class="left">
      <span class="hamb" id="openMenu">☰</span>
    </div>
    <div class="title">AB AGRIWEB</div>
    <div class="rightslot">
      <img id="topbarLogo" alt="">
    </div>
  </div>

  <div class="wrap">
    <!-- قسم الإعدادات: Branding فقط كما طلبت -->
    <div class="acc">
      <div class="acc-sec open" id="accBrand">
        <div class="acc-hd" onclick="toggleAcc(this)">Branding (صور الواجهة)</div>
        <div class="acc-bd">
          <div class="row">
            <!-- خلفية شاشة تسجيل الدخول -->
            <div class="card">
              <h3>Login Background</h3>
              <div class="inp">
                <input id="brand_login_bg_url" type="text" placeholder="assets/image/login-bg.jpg (أو الصق رابط صورة)">
                <button class="btn" type="button" onclick="saveBrandUrl('brand.loginBg','brand_login_bg_url')">Save URL</button>
              </div>
              <div class="hr"></div>
              <label class="muted">أو حمّل صورة (png/jpg/gif)</label>
              <input id="brand_login_bg_file" type="file" accept=".png,.jpg,.jpeg,.gif" onchange="saveBrandFile('brand.loginBg', this)">
              <div class="hint">الحقول وزر الدخول سيظهرون فوق هذه الصورة مباشرة.</div>
            </div>

            <!-- قالب صغير شفاف فوق الحقول -->
            <div class="card">
              <h3>Login Badge (قالب صغير شفاف)</h3>
              <div class="inp">
                <input id="brand_login_badge_url" type="text" placeholder="assets/image/login-badge.png">
                <button class="btn" type="button" onclick="saveBrandUrl('brand.loginBadge','brand_login_badge_url')">Save URL</button>
              </div>
              <div class="hr"></div>
              <label class="muted">أو حمّل صورة (فقط png/gif بخلفية شفافة)</label>
              <input id="brand_login_badge_file" type="file" accept=".png,.gif" onchange="saveBrandFile('brand.loginBadge', this)">
              <div class="hint">تظهر أعلى الحقول في صفحة تسجيل الدخول.</div>
            </div>

            <!-- شعار الشريط العلوي يمين الهامبرغر -->
            <div class="card">
              <h3>Topbar Logo (يمين ☰)</h3>
              <div class="inp">
                <input id="brand_topbar_logo_url" type="text" placeholder="assets/image/topbar-logo.png">
                <button class="btn" type="button" onclick="saveBrandUrl('brand.topbarLogo','brand_topbar_logo_url')">Save URL</button>
              </div>
              <div class="hr"></div>
              <label class="muted">أو حمّل صورة (png/gif/jpg)</label>
              <input id="brand_topbar_logo_file" type="file" accept=".png,.jpg,.jpeg,.gif" onchange="saveBrandFile('brand.topbarLogo', this)">
              <div class="hint">يتم عرض الشعار في الشريط العلوي لهذه الصفحة.</div>
            </div>

            <div class="note">ملاحظة: يمكنك أيضاً وضع الملفات داخل <code>assets/image/</code> ثم استعمال المسار النسبي مباشرة.</div>
          </div>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="muted">إعدادات إضافية ستضاف لاحقاً…</div>
    </div>
  </div>

<script>
  // Toggle accordion
  function toggleAcc(hd){
    const sec = hd.parentElement;
    sec.classList.toggle('open');
  }

  // حفظ URL مباشرة
  function saveBrandUrl(key, inputId){
    const val = document.getElementById(inputId).value.trim();
    if(!val){ alert('ضع مسار الصورة أو رابطها'); return; }
    localStorage.setItem(key, val);
    applyTopbarLogo();
    alert('Saved ✔');
  }

  // حفظ ملف (نحوّل لِـ data URL ونخزّن محلياً)
  function saveBrandFile(key, input){
    const file = input.files && input.files[0];
    if(!file){return;}
    const reader = new FileReader();
    reader.onload = () => {
      localStorage.setItem(key, reader.result);
      applyTopbarLogo();
      alert('Saved ✔');
    };
    reader.readAsDataURL(file);
  }

  // طبّق شعار التوب بار
  function applyTopbarLogo(){
    const src = localStorage.getItem('brand.topbarLogo') || 'assets/image/topbar-logo.png';
    const img = document.getElementById('topbarLogo');
    img.src = src;
  }

  // للسماح بتجاوز الدخول مؤقتاً إن رغبت (يمكنك تعطيله لاحقاً)
  if(!localStorage.getItem('security.bypass')) localStorage.setItem('security.bypass','1');

  // تعبئة الحقول بما هو محفوظ
  function hydrateBrandInputs(){
    const map = [
      ['brand.loginBg','brand_login_bg_url'],
      ['brand.loginBadge','brand_login_badge_url'],
      ['brand.topbarLogo','brand_topbar_logo_url'],
    ];
    map.forEach(([k, id])=>{
      const v = localStorage.getItem(k);
      if(v) document.getElementById(id).value = v;
    });
  }

  applyTopbarLogo();
  hydrateBrandInputs();
</script>
</body>
</html>
