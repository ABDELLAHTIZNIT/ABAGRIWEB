<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>AB AGRIWEB - Dashboard</title>
<style>
  :root{
    --bg:#0f172a; --panel:#0b1220; --text:#e2e8f0; --accent:#22c55e; --border:#243046;
    --tile:#0c1526; --tileIcon:#0f1a2e;
  }
  *{box-sizing:border-box}
  body{
    margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
    background:linear-gradient(180deg,var(--bg),#1e293b); color:var(--text);
    height:100vh; overflow-x:hidden;
  }
  .hidden{display:none}

  /* Header */
  header{
    position:sticky; top:0; z-index:20;
    display:flex; align-items:center; justify-content:space-between;
    background:var(--panel); padding:12px 18px; border-bottom:1px solid var(--border);
    box-shadow:0 2px 12px rgba(0,0,0,.25);
  }
  .menu-btn{ background:none; border:none; color:var(--text); font-size:24px; cursor:pointer; }
  .title{ font-weight:800; color:var(--accent); letter-spacing:.5px }

  /* Sidebar */
  .sidebar{
    position:fixed; top:0; left:-260px; width:260px; height:100%;
    background:#0b1220; border-right:1px solid var(--border);
    transition:left .35s ease; display:flex; flex-direction:column; padding-top:56px;
    box-shadow:4px 0 20px rgba(0,0,0,.4); z-index:15;
  }
  .sidebar.active{ left:0; }
  .side-header{
    position:absolute; top:0; left:0; right:0; height:56px;
    display:flex; align-items:center; gap:10px; padding:0 14px;
    border-bottom:1px solid #1e293b; background:#0b1220;
  }
  .close-btn{
    width:36px; height:36px; border:none; border-radius:8px; cursor:pointer;
    background:#111827; color:#e2e8f0; font-size:22px; line-height:1;
  }
  .close-btn:hover{ background:#0f172a; }
  .side-header span{ font-weight:700; color:#cbd5e1 }

  .sidebar a{
    display:flex; align-items:center; gap:10px; padding:14px 24px;
    color:var(--text) !important; text-decoration:none; border-bottom:1px solid #1e293b;
  }
  .sidebar a:visited{ color:var(--text) !important; }
  .sidebar a:hover{ background:var(--accent); color:#0b1220 !important; font-weight:600; }
  .sidebar a.active{ background:var(--accent); color:#0b1220 !important; font-weight:700; }

  /* Overlay */
  .overlay{
    position:fixed; inset:0; background:rgba(0,0,0,.4);
    opacity:0; pointer-events:none; transition:opacity .3s ease; z-index:10;
  }
  .overlay.active{ opacity:1; pointer-events:all; }

  /* Main content + cards */
  .content{ padding:24px; }
  .card{
    max-width:960px; margin:16px auto; background:#0b1220; border:1px solid var(--border);
    border-radius:16px; padding:20px; box-shadow:0 10px 24px rgba(0,0,0,.25);
  }
  .muted{opacity:.8}

  /* ParamÃ¨tres â€“ tiles */
  .stack{ display:grid; gap:12px; }
  .tile{
    display:flex; align-items:center; gap:12px;
    background:var(--tile); border:1px solid var(--border); border-radius:12px;
    padding:14px 16px; cursor:pointer;
  }
  .tile:hover{ border-color:var(--accent); box-shadow:0 0 0 2px rgba(34,197,94,.25) inset; }
  .tile .icon{
    width:36px; height:36px; display:grid; place-items:center;
    background:var(--tileIcon); border:1px solid #1f2a44; border-radius:10px;
  }
  .tile h4{ margin:0; font-size:16px; }
  .tile p{ margin:2px 0 0; font-size:12px; color:#94a3b8; }

  /* Profiles page */
  .row{ display:flex; gap:10px; flex-wrap:wrap; }
  .input{ width:100%; max-width:300px; padding:12px; border-radius:10px; border:1px solid #334155; background:#091227; color:#e2e8f0; }
  .btn{ padding:12px 14px; border-radius:10px; border:1px solid #22c55e; color:#22c55e; background:transparent; cursor:pointer }
  .btn:hover{ background:#22c55e; color:#0b1220 }
  .list{ display:grid; gap:10px; margin-top:14px; }
  .item{
    display:flex; align-items:center; justify-content:space-between; gap:10px;
    background:#0c1526; border:1px solid #243046; border-radius:10px; padding:12px 14px;
  }
  .item strong{ letter-spacing:.3px }
  .danger{ border-color:#3b1f1f; color:#fca5a5; }
  .danger:hover{ background:#ef4444; color:#0b1220; border-color:#ef4444; }
</style>
</head>
<body>

  <header>
    <button class="menu-btn" onclick="toggleMenu()">â˜°</button>
    <div class="title">AB AGRIWEB</div>
  </header>

  <aside class="sidebar" id="sidebar">
    <div class="side-header">
      <button class="close-btn" onclick="closeMenu()">Ã—</button>
      <span>Menu</span>
    </div>

    <a href="#" id="nav-home" class="active">ğŸ  Accueil</a>
    <a href="#" id="nav-irrig">ğŸŒ¿ Irrigation</a>
    <a href="#" id="nav-trait">ğŸ’§ Traitement</a>
    <a href="#" id="nav-settings">âš™ï¸ ParamÃ¨tres</a>
    <a href="#" id="logout">ğŸšª Logout</a>
  </aside>

  <div class="overlay" id="overlay"></div>

  <main class="content">
    <!-- PAGE: Accueil -->
    <section id="page-home" class="card">
      <h2>Bienvenue ğŸ‘‹</h2>
      <p class="muted">Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø© Ù…Ø¨Ø¯Ø¦ÙŠØ©. Ù…Ù† Ù‡Ù†Ø§ Ø³Ù†Ø¶ÙŠÙ Ø£Ù‚Ø³Ø§Ù… Irrigation / Traitement / ParamÃ¨tres Ù„Ø§Ø­Ù‚Ù‹Ø§.</p>
    </section>

    <!-- PAGE: ParamÃ¨tres (menu de tuiles) -->
    <section id="page-settings" class="card hidden">
      <h2>ParamÃ¨tres</h2>
      <p class="muted">Ø§Ø®ØªØ± Ø£Ø­Ø¯ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªØ§Ù„ÙŠØ©:</p>
      <div class="stack">
        <div class="tile" onclick="showPage('profiles'); setActiveTile('profiles')">
          <div class="icon">
            <!-- id-badge -->
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
              <rect x="4" y="5" width="16" height="14" rx="2" stroke="#22c55e" stroke-width="2"/>
              <circle cx="12" cy="11" r="2.5" stroke="#22c55e" stroke-width="2"/>
              <path d="M8 17c1.2-1.5 3-2.3 4-2.3s2.8.8 4 2.3" stroke="#22c55e" stroke-width="2" stroke-linecap="round"/>
            </svg>
          </div>
          <div>
            <h4>PROFILE</h4>
            <p>Gestion des profils (rÃ´les)</p>
          </div>
        </div>

        <div class="tile" onclick="alert('OPÃ‰RATEUR (Ã  complÃ©ter)')">
          <div class="icon">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
              <circle cx="12" cy="8" r="4" stroke="#22c55e" stroke-width="2"/>
              <path d="M4 20c1.8-3.5 5-5 8-5s6.2 1.5 8 5" stroke="#22c55e" stroke-width="2" stroke-linecap="round"/>
            </svg>
          </div>
          <div>
            <h4>OPÃ‰RATEUR</h4>
            <p>Gestion des opÃ©rateurs</p>
          </div>
        </div>

        <div class="tile" onclick="alert('DROITS ACCÃˆS (Ã  complÃ©ter)')">
          <div class="icon">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
              <path d="M12 3l7 3v6c0 5-3.5 7.8-7 9-3.5-1.2-7-4-7-9V6l7-3z" stroke="#22c55e" stroke-width="2"/>
              <path d="M9 12l2 2 4-4" stroke="#22c55e" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
          <div>
            <h4>DROITS ACCÃˆS</h4>
            <p>Permissions & rÃ´les</p>
          </div>
        </div>

        <div class="tile" onclick="alert('MOT DE PASSE (Ã  complÃ©ter)')">
          <div class="icon">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
              <circle cx="8" cy="12" r="3" stroke="#22c55e" stroke-width="2"/>
              <path d="M11 12h9M17 12v3M20 12v3" stroke="#22c55e" stroke-width="2" stroke-linecap="round"/>
            </svg>
          </div>
          <div>
            <h4>MOT DE PASSE</h4>
            <p>Changer le mot de passe</p>
          </div>
        </div>
      </div>
    </section>

    <!-- PAGE: Profiles (CRUD simple) -->
    <section id="page-profiles" class="card hidden">
      <h2>Profiles</h2>
      <p class="muted">Ø£Ø¶Ù/Ø§Ø­Ø°Ù Ø£Ø¯ÙˆØ§Ø± (Profils) ÙˆØ³ÙŠØªÙ… Ø­ÙØ¸Ù‡Ø§ Ù…Ø­Ù„ÙŠÙ‹Ø§ ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­.</p>

      <div class="row" style="margin-top:12px">
        <input id="profileName" class="input" placeholder="Ex: Admin, Magasinier, Pointeur, Directeur">
        <button class="btn" onclick="addProfile()">Ajouter le profil</button>
      </div>

      <div id="profilesList" class="list"></div>

      <p class="muted" style="margin-top:10px">Tip: Ø³ÙŠØªÙ… Ø­ÙØ¸ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© ÙÙŠ <code>localStorage</code> ØªØ­Øª Ø§Ù„Ù…ÙØªØ§Ø­ <b>ab_profiles</b>.</p>
      <div class="row" style="margin-top:6px">
        <button class="btn danger" onclick="resetDefaults()">RÃ©initialiser aux rÃ´les par dÃ©faut</button>
      </div>
    </section>
  </main>

<script>
  // Sidebar + overlay
  const sidebar  = document.getElementById('sidebar');
  const overlay  = document.getElementById('overlay');

  function openMenu(){ sidebar.classList.add('active'); overlay.classList.add('active'); }
  function closeMenu(){ sidebar.classList.remove('active'); overlay.classList.remove('active'); }
  function toggleMenu(){ sidebar.classList.contains('active') ? closeMenu() : openMenu(); }
  document.addEventListener('keydown', e => { if(e.key === 'Escape') closeMenu(); });
  overlay.addEventListener('click', closeMenu);
  document.querySelectorAll('.sidebar a').forEach(a => a.addEventListener('click', closeMenu));

  // Simple pages router
  const navHome  = document.getElementById('nav-home');
  const navSet   = document.getElementById('nav-settings');
  const pageHome = document.getElementById('page-home');
  const pageSet  = document.getElementById('page-settings');
  const pageProf = document.getElementById('page-profiles');

  function setActiveLink(link){
    document.querySelectorAll('.sidebar a').forEach(a=>a.classList.remove('active'));
    link.classList.add('active');
  }

  function showPage(name){
    // hide all
    [pageHome, pageSet, pageProf].forEach(el=>el.classList.add('hidden'));
    if(name==='home') pageHome.classList.remove('hidden');
    if(name==='settings') pageSet.classList.remove('hidden');
    if(name==='profiles') pageProf.classList.remove('hidden');
    closeMenu();
  }

  // From sidebar
  navHome.addEventListener('click', (e)=>{ e.preventDefault(); setActiveLink(navHome); showPage('home'); });
  navSet .addEventListener('click', (e)=>{ e.preventDefault(); setActiveLink(navSet ); showPage('settings'); });

  // From settings tile
  function setActiveTile(which){
    // when coming from tiles, keep Settings as active link
    setActiveLink(navSet);
  }

  // Logout â†’ back to login
  document.getElementById('logout').addEventListener('click', e=>{
    e.preventDefault(); window.location = 'index.html';
  });

  /* ---------------- Profiles (localStorage) ---------------- */
  const LS_KEY = 'ab_profiles';
  const DEFAULTS = ["Admin","Magasinier","Pointeur","Directeur"];

  function loadProfiles(){
    const raw = localStorage.getItem(LS_KEY);
    let items = [];
    try{ items = raw ? JSON.parse(raw) : []; }catch{ items = []; }
    if(!Array.isArray(items)) items = [];
    return items;
  }
  function saveProfiles(arr){
    localStorage.setItem(LS_KEY, JSON.stringify(arr));
  }
  function renderProfiles(){
    const list = document.getElementById('profilesList');
    const data = loadProfiles();
    if(data.length===0){
      list.innerHTML = `<div class="item"><span class="muted">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨Ø±ÙˆÙØ§ÙŠÙ„Ø§Øª Ø¨Ø¹Ø¯.</span></div>`;
      return;
    }
    list.innerHTML = data.map((name,idx)=>`
      <div class="item">
        <strong>${escapeHtml(name)}</strong>
        <button class="btn danger" onclick="removeProfile(${idx})">Supprimer</button>
      </div>
    `).join('');
  }
  function addProfile(){
    const inp = document.getElementById('profileName');
    const name = inp.value.trim();
    if(!name){ alert("Entrer un nom de profil."); return; }
    const data = loadProfiles();
    if(data.some(x=>x.toLowerCase()===name.toLowerCase())){
      alert("Ce profil existe dÃ©jÃ ."); return;
    }
    data.push(name);
    saveProfiles(data);
    inp.value='';
    renderProfiles();
    alert("Profil ajoutÃ© âœ…");
  }
  function removeProfile(idx){
    const data = loadProfiles();
    const name = data[idx];
    if(!confirm(`Supprimer le profil: ${name} ?`)) return;
    data.splice(idx,1);
    saveProfiles(data);
    renderProfiles();
  }
  function resetDefaults(){
    if(!confirm("RÃ©initialiser aux rÃ´les par dÃ©faut ?")) return;
    saveProfiles(DEFAULTS.slice());
    renderProfiles();
  }
  function escapeHtml(s){
    return s.replace(/[&<>"']/g, m=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;' }[m]));
  }

  // init: ensure defaults on first run
  (function init(){
    const raw = localStorage.getItem(LS_KEY);
    if(!raw){ saveProfiles(DEFAULTS.slice()); }
    renderProfiles();
  })();
</script>

</body>
</html>
